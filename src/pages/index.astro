---
import TimelineChart from '@/components/Chart'
import Layout from '@layouts/Layout.astro'

import jsonData from './../data/data.json'

import type { TimelineChartConfig } from '@types'
import { timeParse } from 'd3'

const config: TimelineChartConfig = {
	width: 800,
	height: 500,
	xAxisConfig: {
		domain: ['2015-02-01', '2025-03-28'],
		ticksConfig: {
			startDate: '2015-03-01',
			numTicks: 11,
			dateInterval: 'year',
			intervalStep: 1,
			dateFormat: '%m/%y',
		},
	},
	yAxisConfig: {
		left: {
			domain: [1500, 6500],
			ticksConfig: {
				startVal: 1500,
				numTicks: 11,
				tickInterval: 500,
				numberFormat: ',.2r',
			},
			guideLines: true,
		},
		right: {
			domain: [120, 320],
			ticksConfig: {
				startVal: 120,
				numTicks: 11,
				tickInterval: 20,
				numberFormat: ',.2r',
			},
		},
	},
	modules: [
		{
			type: 'lineChart',
			series: ['S&P 500 Index', 'S&P 500 EPS forecast, next 12 months'],
		},
	],
}
const parser = timeParse('%d/%m/%Y')
const [dateKey, ...seriesKeys] = Object.keys(jsonData[0])
const data = jsonData.map((entry) => ({ ...entry, Date: parser(entry[dateKey]) }))
// console.log(data)
---

<Layout>
	<TimelineChart data={data} config={config} client:load />
</Layout>
